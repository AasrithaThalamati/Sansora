// Global Variables
let currentUser = null;
let isAdmin = false;
let cart = JSON.parse(localStorage.getItem('sansora_cart') || '[]');
let currentSlide = 0;

// Product Database
const products = [
    // Electronics
    {
        id: 1,
        title: "iPhone 15 Pro Max",
        category: "electronics",
        price: 134900,
        image: "https://images.unsplash.com/photo-1678685888221-cda773a3dcdb?w=400&h=300&fit=crop",
        description: "Latest iPhone with A17 Pro chip, titanium design, and advanced camera system. Features 256GB storage, ProRAW photography, and all-day battery life."
    },
    {
        id: 2,
        title: "Samsung Galaxy S24 Ultra",
        category: "electronics",
        price: 129999,
        image: "https://images.unsplash.com/photo-1610945265064-0e34e5519bbf?w=400&h=300&fit=crop",
        description: "Premium Android flagship with S Pen, 200MP camera, AI features, and stunning 6.8\" Dynamic AMOLED display."
    },
    {
        id: 3,
        title: "MacBook Pro 16-inch",
        category: "electronics",
        price: 249900,
        image: "https://images.unsplash.com/photo-1541807084-5c52b6b3adef?w=400&h=300&fit=crop",
        description: "Apple's most powerful laptop with M3 Pro chip, 16GB RAM, 512GB SSD, and Liquid Retina XDR display."
    },
    {
        id: 4,
        title: "Sony WH-1000XM5 Headphones",
        category: "electronics",
        price: 29990,
        image: "https://images.unsplash.com/photo-1505740420928-5e560c06d30e?w=400&h=300&fit=crop",
        description: "Industry-leading noise canceling headphones with 30-hour battery life and premium sound quality."
    },
    {
        id: 5,
        title: "iPad Pro 12.9-inch",
        category: "electronics",
        price: 112900,
        image: "https://images.unsplash.com/photo-1544244015-0df4b3ffc6b0?w=400&h=300&fit=crop",
        description: "Professional tablet with M2 chip, Liquid Retina XDR display, and Apple Pencil compatibility."
    },
    {
        id: 6,
        title: "Dell XPS 15",
        category: "electronics",
        price: 189999,
        image: "https://images.unsplash.com/photo-1593640495253-23196b27a87f?w=400&h=300&fit=crop",
        description: "Premium Windows laptop with Intel i7, 16GB RAM, RTX 4070 graphics, and 15.6\" OLED display."
    },
    {
        id: 7,
        title: "Apple Watch Series 9",
        category: "electronics",
        price: 41900,
        image: "https://images.unsplash.com/photo-1579586337278-3f436f25d4d6?w=400&h=300&fit=crop",
        description: "Advanced smartwatch with health tracking, GPS, cellular connectivity, and S9 SiP chip."
    },
    {
        id: 8,
        title: "Nintendo Switch OLED",
        category: "electronics",
        price: 32999,
        image: "https://images.unsplash.com/photo-1606144042614-b2417e99c4e3?w=400&h=300&fit=crop",
        description: "Portable gaming console with 7-inch OLED screen, 64GB storage, and versatile play modes."
    },

    // Fashion
    {
        id: 9,
        title: "Premium Leather Jacket",
        category: "fashion",
        price: 12999,
        image: "https://images.unsplash.com/photo-1551028719-00167b16eac5?w=400&h=300&fit=crop",
        description: "Genuine leather jacket with modern fit, multiple pockets, and timeless design. Available in black and brown."
    },
    {
        id: 10,
        title: "Designer Silk Dress",
        category: "fashion",
        price: 8999,
        image: "https://images.unsplash.com/photo-1595777457583-95e059d581b8?w=400&h=300&fit=crop",
        description: "Elegant silk dress perfect for special occasions. Features flattering cut and premium fabric quality."
    },
    {
        id: 11,
        title: "Luxury Swiss Watch",
        category: "fashion",
        price: 45999,
        image: "https://images.unsplash.com/photo-1523170335258-f5c54ae6c5a7?w=400&h=300&fit=crop",
        description: "Precision Swiss-made timepiece with automatic movement, sapphire crystal, and water resistance."
    },
    {
        id: 12,
        title: "Designer Sunglasses",
        category: "fashion",
        price: 15999,
        image: "https://images.unsplash.com/photo-1572635196237-14b3f281503f?w=400&h=300&fit=crop",
        description: "Premium polarized sunglasses with UV protection and scratch-resistant lenses."
    },
    {
        id: 13,
        title: "Cashmere Sweater",
        category: "fashion",
        price: 18999,
        image: "https://images.unsplash.com/photo-1576871337632-b9aef4c17ab9?w=400&h=300&fit=crop",
        description: "Ultra-soft cashmere sweater in multiple colors. Perfect for luxury comfort and style."
    },
    {
        id: 14,
        title: "Italian Leather Handbag",
        category: "fashion",
        price: 22999,
        image: "https://images.unsplash.com/photo-1584917865442-de89df76afd3?w=400&h=300&fit=crop",
        description: "Handcrafted Italian leather handbag with multiple compartments and gold-tone hardware."
    },

    // Home & Kitchen
    {
        id: 15,
        title: "Smart Coffee Maker",
        category: "home",
        price: 24999,
        image: "https://images.unsplash.com/photo-1495474472287-4d71bcdd2085?w=400&h=300&fit=crop",
        description: "WiFi-enabled coffee maker with app control, programmable brewing, and thermal carafe."
    },
    {
        id: 16,
        title: "Robot Vacuum Cleaner",
        category: "home",
        price: 32999,
        image: "https://images.unsplash.com/photo-1558618666-fcd25c85cd64?w=400&h=300&fit=crop",
        description: "Smart robotic vacuum with mapping technology, app control, and automatic charging dock."
    },
    {
        id: 17,
        title: "Air Fryer Pro",
        category: "home",
        price: 14999,
        image: "https://images.unsplash.com/photo-1610501881919-67bd3c4ba789?w=400&h=300&fit=crop",
        description: "Large capacity air fryer with digital controls, multiple cooking presets, and non-stick basket."
    },
    {
        id: 18,
        title: "Smart Thermostat",
        category: "home",
        price: 18999,
        image: "https://images.unsplash.com/photo-1545259741-2ea3ebf61fa1?w=400&h=300&fit=crop",
        description: "Energy-saving smart thermostat with WiFi connectivity and learning algorithms."
    },
    {
        id: 19,
        title: "Luxury Bedding Set",
        category: "home",
        price: 12999,
        image: "https://images.unsplash.com/photo-1631049307264-da0ec9d70304?w=400&h=300&fit=crop",
        description: "Premium Egyptian cotton bedding set with thread count 1000. Includes sheets, pillowcases, and duvet cover."
    },
    {
        id: 20,
        title: "Chef's Knife Set",
        category: "home",
        price: 19999,
        image: "https://images.unsplash.com/photo-1593618998160-e34014c4fb30?w=400&h=300&fit=crop",
        description: "Professional-grade knife set with high-carbon steel blades and ergonomic handles."
    },

    // Books
    {
        id: 21,
        title: "The Psychology of Success",
        category: "books",
        price: 899,
        image: "https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=400&h=300&fit=crop",
        description: "Bestselling guide to achieving personal and professional success through proven psychological principles."
    },
    {
        id: 22,
        title: "Digital Marketing Mastery",
        category: "books",
        price: 1299,
        image: "https://images.unsplash.com/photo-1481627834876-b7833e8f5570?w=400&h=300&fit=crop",
        description: "Comprehensive guide to modern digital marketing strategies and tools for businesses."
    },
    {
        id: 23,
        title: "Cooking Around the World",
        category: "books",
        price: 1599,
        image: "https://images.unsplash.com/photo-1544716278-ca5e3f4abd8c?w=400&h=300&fit=crop",
        description: "Beautiful cookbook featuring authentic recipes from 50 countries with stunning photography."
    },
    {
        id: 24,
        title: "Investment Strategies",
        category: "books",
        price: 1199,
        image: "https://images.unsplash.com/photo-1554224155-8d04cb21cd6c?w=400&h=300&fit=crop",
        description: "Expert advice on building wealth through smart investment decisions and portfolio management."
    },
    {
        id: 25,
        title: "Mindfulness and Meditation",
        category: "books",
        price: 799,
        image: "https://images.unsplash.com/photo-1512820790803-83ca734da794?w=400&h=300&fit=crop",
        description: "Practical guide to mindfulness practices and meditation techniques for stress reduction."
    },

    // Sports
    {
        id: 26,
        title: "Professional Tennis Racket",
        category: "sports",
        price: 18999,
        image: "https://images.unsplash.com/photo-1622279457486-62dcc4a431d6?w=400&h=300&fit=crop",
        description: "Tournament-grade tennis racket with carbon fiber construction and perfect balance."
    },
    {
        id: 27,
        title: "Yoga Mat Premium",
        category: "sports",
        price: 4999,
        image: "https://images.unsplash.com/photo-1506629905057-f52b90ea5adc?w=400&h=300&fit=crop",
        description: "High-quality yoga mat with superior grip, cushioning, and eco-friendly materials."
    },
    {
        id: 28,
        title: "Fitness Tracker Pro",
        category: "sports",
        price: 12999,
        image: "https://images.unsplash.com/photo-1611932388052-b8c2e1c5c0fe?w=400&h=300&fit=crop",
        description: "Advanced fitness tracker with heart rate monitoring, GPS, and 20+ workout modes."
    },
    {
        id: 29,
        title: "Professional Basketball",
        category: "sports",
        price: 3999,
        image: "https://images.unsplash.com/photo-1546519638-68e109498ffc?w=400&h=300&fit=crop",
        description: "Official size basketball with premium leather construction and superior grip."
    },
    {
        id: 30,
        title: "Swimming Goggles Pro",
        category: "sports",
        price: 2999,
        image: "https://images.unsplash.com/photo-1530549387789-4c1017266635?w=400&h=300&fit=crop",
        description: "Professional swimming goggles with anti-fog coating and UV protection."
    },

    // Additional Electronics
    {
        id: 31,
        title: "4K Webcam Ultra",
        category: "electronics",
        price: 15999,
        image: "https://images.unsplash.com/photo-1627398242454-45a1465c2479?w=400&h=300&fit=crop",
        description: "Ultra HD webcam with autofocus, noise reduction, and professional streaming capabilities."
    },
    {
        id: 32,
        title: "Wireless Gaming Mouse",
        category: "electronics",
        price: 8999,
        image: "https://images.unsplash.com/photo-1527814050087-3793815479db?w=400&h=300&fit=crop",
        description: "High-precision gaming mouse with RGB lighting and customizable buttons."
    },
    {
        id: 33,
        title: "Bluetooth Speaker Premium",
        category: "electronics",
        price: 19999,
        image: "https://images.unsplash.com/photo-1608043152269-423dbba4e7e1?w=400&h=300&fit=crop",
        description: "Portable speaker with 360-degree sound, waterproof design, and 24-hour battery."
    },

    // Additional Fashion
    {
        id: 34,
        title: "Premium Denim Jeans",
        category: "fashion",
        price: 7999,
        image: "https://images.unsplash.com/photo-1542272604-787c3835535d?w=400&h=300&fit=crop",
        description: "Designer jeans with perfect fit, premium denim fabric, and modern styling."
    },
    {
        id: 35,
        title: "Luxury Perfume Set",
        category: "fashion",
        price: 12999,
        image: "https://images.unsplash.com/photo-1541643600914-78b084683601?w=400&h=300&fit=crop",
        description: "Collection of premium fragrances in elegant packaging. Long-lasting and sophisticated scents."
    },

    // Additional Home & Kitchen
    {
        id: 36,
        title: "Smart Home Security System",
        category: "home",
        price: 34999,
        image: "https://images.unsplash.com/photo-1558618047-3c8c76ca7d13?w=400&h=300&fit=crop",
        description: "Complete security system with cameras, sensors, and smart alerts for home protection."
    },
    {
        id: 37,
        title: "Espresso Machine Deluxe",
        category: "home",
        price: 45999,
        image: "https://images.unsplash.com/photo-1559056199-641a0ac8b55e?w=400&h=300&fit=crop",
        description: "Professional espresso machine with built-in grinder and milk frother."
    },

    // Additional Books
    {
        id: 38,
        title: "Art of Leadership",
        category: "books",
        price: 999,
        image: "https://images.unsplash.com/photo-1481627834876-b7833e8f5570?w=400&h=300&fit=crop",
        description: "Essential guide to developing leadership skills and inspiring teams to achieve excellence."
    },
    {
        id: 39,
        title: "Photography Masterclass",
        category: "books",
        price: 1899,
        image: "https://images.unsplash.com/photo-1516979187457-637abb4f9353?w=400&h=300&fit=crop",
        description: "Complete photography course covering techniques from basics to advanced professional skills."
    },

    // Additional Sports
    {
        id: 40,
        title: "Home Gym Equipment Set",
        category: "sports",
        price: 49999,
        image: "https://images.unsplash.com/photo-1571019613454-1cb2f99b2d8b?w=400&h=300&fit=crop",
        description: "Complete home gym setup with adjustable dumbbells, resistance bands, and workout guide."
    },
    {
        id: 41,
        title: "Professional Golf Clubs Set",
        category: "sports",
        price: 89999,
        image: "https://images.unsplash.com/photo-1587174486073-ae5e5cec365d?w=400&h=300&fit=crop",
        description: "Premium golf club set with titanium drivers, steel irons, and professional-grade putters."
    },

    // More Products to reach 50+
    {
        id: 42,
        title: "Smart TV 65-inch OLED",
        category: "electronics",
        price: 179999,
        image: "https://images.unsplash.com/photo-1593359677879-a4bb92f829d1?w=400&h=300&fit=crop",
        description: "Ultra HD OLED smart TV with HDR, Dolby Atmos, and AI-enhanced picture processing."
    },
    {
        id: 43,
        title: "Designer Backpack",
        category: "fashion",
        price: 11999,
        image: "https://images.unsplash.com/photo-1553062407-98eeb64c6a62?w=400&h=300&fit=crop",
        description: "Premium leather backpack with laptop compartment and modern design aesthetic."
    },
    {
        id: 44,
        title: "Smart Doorbell Camera",
        category: "home",
        price: 16999,
        image: "https://images.unsplash.com/photo-1558618047-3c8c76ca7d13?w=400&h=300&fit=crop",
        description: "Video doorbell with motion detection, two-way audio, and cloud storage."
    },
    {
        id: 45,
        title: "Science Fiction Collection",
        category: "books",
        price: 2499,
        image: "https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=400&h=300&fit=crop",
        description: "Box set of classic science fiction novels from renowned authors."
    },
    {
        id: 46,
        title: "Marathon Running Shoes",
        category: "sports",
        price: 14999,
        image: "https://images.unsplash.com/photo-1542291026-7eec264c27ff?w=400&h=300&fit=crop",
        description: "Professional running shoes with advanced cushioning and lightweight design."
    },
    {
        id: 47,
        title: "Drone with 4K Camera",
        category: "electronics",
        price: 79999,
        image: "https://images.unsplash.com/photo-1507582020474-9a35b7d455d9?w=400&h=300&fit=crop",
        description: "Professional drone with 4K video recording, GPS stabilization, and 30-minute flight time."
    },
    {
        id: 48,
        title: "Vintage Leather Jacket",
        category: "fashion",
        price: 16999,
        image: "https://images.unsplash.com/photo-1551028719-00167b16eac5?w=400&h=300&fit=crop",
        description: "Authentic vintage-style leather jacket with distressed finish and classic cut."
    },
    {
        id: 49,
        title: "Smart Kitchen Scale",
        category: "home",
        price: 5999,
        image: "https://images.unsplash.com/photo-1556909114-f6e7ad7d3136?w=400&h=300&fit=crop",
        description: "Digital kitchen scale with app connectivity and nutritional information tracking."
    },
    {
        id: 50,
        title: "Mountain Bike Professional",
        category: "sports",
        price: 159999,
        image: "https://images.unsplash.com/photo-1558618047-3c8c76ca7d13?w=400&h=300&fit=crop",
        description: "High-performance mountain bike with carbon fiber frame and advanced suspension system."
    }
];

// Authentication System
function initializeAuth() {
    const savedUser = localStorage.getItem('sansora_user');
    if (savedUser) {
        const userData = JSON.parse(savedUser);
        currentUser = userData.username;
        isAdmin = userData.isAdmin;
        
        if (window.location.pathname.includes('login.html')) {
            window.location.href = 'index.html';
        }
    } else {
        if (!window.location.pathname.includes('login.html') && !window.location.pathname.includes('signup.html')) {
            window.location.href = 'login.html';
        }
    }
}

// Login Form Handler
if (document.getElementById('loginForm')) {
    document.getElementById('loginForm').addEventListener('submit', function(e) {
        e.preventDefault();
        
        const username = document.getElementById('username').value.trim();
        const password = document.getElementById('password').value;
        
        // User authentication
        if (username === 'Aasritha_Thalamati' && password === '1234') {
            const userData = { username: username, isAdmin: false };
            localStorage.setItem('sansora_user', JSON.stringify(userData));
            currentUser = username;
            isAdmin = false;
            showMessage('Login successful! Welcome back!', 'success');
            setTimeout(() => window.location.href = 'index.html', 1500);
        }
        // Admin authentication
        else if (username === 'admin' && password === 'admin123') {
            const userData = { username: username, isAdmin: true };
            localStorage.setItem('sansora_user', JSON.stringify(userData));
            currentUser = username;
            isAdmin = true;
            showMessage('Admin login successful!', 'success');
            setTimeout(() => window.location.href = 'admin.html', 1500);
        }
        else {
            showMessage('Invalid username or password!', 'error');
        }
    });
}

// Logout Function
function logout() {
    localStorage.removeItem('sansora_user');
    localStorage.removeItem('sansora_cart');
    currentUser = null;
    isAdmin = false;
    cart = [];
    window.location.href = 'login.html';
}

// Message Display Function
function showMessage(text, type) {
    const messageDiv = document.getElementById('loginMessage') || document.createElement('div');
    messageDiv.id = 'loginMessage';
    messageDiv.className = `message-popup ${type}`;
    messageDiv.textContent = text;
    
    if (!document.getElementById('loginMessage')) {
        document.body.appendChild(messageDiv);
    }
    
    setTimeout(() => messageDiv.classList.add('show'), 100);
    
    setTimeout(() => {
        messageDiv.classList.remove('show');
        setTimeout(() => messageDiv.remove(), 300);
    }, 3000);
}

// Hero Slider Functionality
function initializeSlider() {
    const slides = document.querySelectorAll('.slide');
    if (slides.length === 0) return;
    
    setInterval(() => {
        slides[currentSlide].classList.remove('active');
        currentSlide = (currentSlide + 1) % slides.length;
        slides[currentSlide].classList.add('active');
    }, 5000);
}

// Product Display Functions
function displayProducts(productsToShow = products) {
    const productsGrid = document.getElementById('products-grid');
    if (!productsGrid) return;
    
    productsGrid.innerHTML = productsToShow.map(product => `
        <div class="product-card" data-category="${product.category}">
            <img src="${product.image}" alt="${product.title}" class="product-image" onclick="viewProduct(${product.id})">
            <div class="product-info">
                <div class="product-category">${product.category}</div>
                <h3 class="product-title">${product.title}</h3>
                <p class="product-description">${product.description}</p>
                <div class="product-price">â‚¹${product.price.toLocaleString('en-IN')}</div>
                <button class="add-to-cart" onclick="addToCart(${product.id})">
                    <i class="fas fa-cart-plus"></i> Add to Cart
                </button>
            </div>
        </div>
    `).join('');
}

function filterProducts(category) {
    const filteredProducts = category === 'all' ? products : products.filter(p => p.category === category);
    displayProducts(filteredProducts);
    
    // Update active filter button
    document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
    event.target.classList.add('active');
}

function viewProduct(productId) {
    const product = products.find(p => p.id === productId);
    if (product) {
        localStorage.setItem('selectedProduct', JSON.stringify(product));
        window.location.href = 'product-details.html';
    }
}

// Cart Functions
function addToCart(productId) {
    const product = products.find(p => p.id === productId);
    if (!product) return;
    
    const existingItem = cart.find(item => item.id === productId);
    if (existingItem) {
        existingItem.quantity += 1;
    } else {
        cart.push({ ...product, quantity: 1 });
    }
    
    updateCartCount();
    saveCart();
    showMessage(`${product.title} added to cart!`, 'success');
}

function removeFromCart(productId) {
    cart = cart.filter(item => item.id !== productId);
    updateCartCount();
    saveCart();
    displayCart();
}

function updateQuantity(productId, newQuantity) {
    if (newQuantity <= 0) {
        removeFromCart(productId);
        return;
    }
    
    const item = cart.find(item => item.id === productId);
    if (item) {
        item.quantity = newQuantity;
        updateCartCount();
        saveCart();
        displayCart();
    }
}

function updateCartCount() {
    const cartCount = document.getElementById('cart-count');
    if (cartCount) {
        const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
        cartCount.textContent = totalItems;
    }
}

function saveCart() {
    localStorage.setItem('sansora_cart', JSON.stringify(cart));
}

function loadCart() {
    const savedCart = localStorage.getItem('sansora_cart');
    if (savedCart) {
        cart = JSON.parse(savedCart);
        updateCartCount();
    }
}

// Navigation Functions
function showCategories() {
    // Scroll to category filter section
    const categoryFilter = document.querySelector('.category-filter');
    if (categoryFilter) {
        categoryFilter.scrollIntoView({ behavior: 'smooth' });
    }
}

function showDeals() {
    // Filter products by discount (simulate deals)
    const dealProducts = products.filter((_, index) => index % 3 === 0);
    displayProducts(dealProducts);
    
    const productsContainer = document.querySelector('.products-container');
    if (productsContainer) {
        document.querySelector('.section-title').textContent = 'Special Deals & Offers';
        productsContainer.scrollIntoView({ behavior: 'smooth' });
    }
}

function showAccount() {
    if (currentUser) {
        alert(`Account: ${currentUser}\nType: ${isAdmin ? 'Admin' : 'User'}`);
    }
}

// Initialize everything when page loads
document.addEventListener('DOMContentLoaded', function() {
    initializeAuth();
    
    if (currentUser) {
        loadCart();
        initializeSlider();
        
        // Only display products if we're on the home page
        if (document.getElementById('products-grid')) {
            displayProducts();
        }
        
        // Update user-specific UI
        updateCartCount();
    }
});

// Additional utility functions for other pages will be loaded as needed
window.sansora = {
    products,
    cart,
    addToCart,
    removeFromCart,
    updateQuantity,
    currentUser,
    isAdmin,
    showMessage,
    logout
};